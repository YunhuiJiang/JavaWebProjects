<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.deepsl.hrm.dao.UserDao">
  
   <select id="selectByLoginnameAndPassword" parameterType="hashmap"  resultType="org.deepsl.hrm.domain.User" >
		 select * from  user_inf  where loginname = #{loginname} and password = #{password} 
   </select>
   
   <select id="selectById" parameterType="int"  resultType="org.deepsl.hrm.domain.User" >
		 select * from  user_inf  where id=#{id}
   </select>
   
   <delete id="deleteById" parameterType="int" >
   		delete from user_inf where id=#{id}
   </delete>
   
   
    <insert id="save" parameterType="org.deepsl.hrm.domain.User" >
  		<selectKey keyProperty="id" resultType="Integer" order="AFTER">
			select LAST_INSERT_ID()
		</selectKey>
   		insert into user_inf (username,loginname,status,password,createDate) values(#{username},#{ loginname} ,#{status},#{password},#{createDate})
   </insert>
   
   <update id="update" parameterType="org.deepsl.hrm.domain.User">
   		update user_inf  
   		<trim prefix="set" suffixOverrides=",">
   			<if test="username!=null and username.trim()!=''">
	         	 username=#{username},
	         </if>
	         <if test="password!=null and password.trim()!=''">
	         	 password=#{password},
	         </if>
	          <if test="loginname!=null and loginname.trim()!=''">
	         	 loginname=#{loginname},
	         </if>
	         <if test="status!=null and (status=1 or status=2) ">
	         	 status=#{status},
	         </if>
	    </trim>
 			WHERE id=#{id}
   </update>
   

	
	<!-- <resultMap type="user" id="userList">
		<id 
	</resultMap> -->
	<select id="count" parameterType="hashmap"  resultType="Integer" >
		 select count(*) from  user_inf  
		 <where>
		 	<trim prefix=" " suffixOverrides="and">
   			<if test="user.username!=null and user.username.trim()!=''">
	         	 username like #{user.username} and
	         </if>
	         <if test="user.status!=null and (user.status=1 or user.status=2) ">
	         	 status=#{user.status} and 
	         </if>
	    </trim>
		 </where>	 
   </select>
   
   
	<select id="selectByPage" parameterType="hashmap"  resultType="org.deepsl.hrm.domain.User" >
		 select * from  user_inf  
		 <where>
		 	<trim prefix=" " suffixOverrides="and">
   			<if test="user.username!=null and user.username.trim()!=''">
	         	 username like #{user.username} and
	         </if>
	         <if test="user.status!=null and (user.status=1 or user.status=2) ">
	         	 status=#{user.status} and 
	         </if>
	    </trim>
		 </where>
		 
   			<if test="pageModel.pageSize!=null ">
	         	 limit #{pageModel.pageSize} 
	         </if>
	         <if test="pageModel.pageIndex!=null ">
	         	 offset #{pageModel.firstLimitParam}
	         </if>		 
   </select>

</mapper>